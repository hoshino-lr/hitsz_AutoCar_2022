CMAKE_MINIMUM_REQUIRED(VERSION 3.10)

PROJECT(HITSZ-AUTOCAR)
SET(CMAKE_CXX_STANDARD 14)
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++14")
set(use_hk true)
add_compile_options(-O3)

# OpenCV
find_package(OpenCV 4.5 REQUIRED)
# link_directories(${OpenCV_LIBRARY_DIRS})

# cuda
find_package(CUDA REQUIRED)
include_directories(/usr/local/cuda/include)
link_directories(/usr/local/cuda/lib64)

#Include
include_directories(${PROJECT_SOURCE_DIR}/Camera/include)
include_directories(${PROJECT_SOURCE_DIR}/Armor/include)
include_directories(${PROJECT_SOURCE_DIR}/Net/include)
include_directories(${PROJECT_SOURCE_DIR}/Lidar/include)
include_directories(${PROJECT_SOURCE_DIR}/Config/include)
include_directories(${PROJECT_SOURCE_DIR}/Com/include)
include_directories(${PROJECT_SOURCE_DIR}/Pos/include)
include_directories(/opt/MVS/include)
include_directories(../tiny-tensorrt)

#Link
link_directories(/opt/MVS/lib/64)
link_directories(/opt/MVS/lib/aarch64)
link_directories(../tiny-tensorrt/build)


if (use_hk)
    message(STATUS "Linking HKROBOT camera lib on linux...")
    add_definitions("-DUSE_HK")
    link_libraries(-lMvCameraControl)
endif ()
# Resources

file(GLOB_RECURSE resources "${PROJECT_SOURCE_DIR}/resources/*")
message(STATUS "Copying resources file(s): ${resources}")
file(COPY ${resources} DESTINATION ${CMAKE_BINARY_DIR}/)

# find_package(glog REQUIRED)
#Src
file(GLOB_RECURSE sourcefiles 
"Pos/**/*.cpp"
"Camera/**/*.cpp"
"Design/**/*.cpp"
"Lidar/**/*.cpp" 
"Net/**/*.cpp"
"Config/**/*.cpp"
"Com/**/*.cpp" "Com/**/*.cc" "Com/**/*.c"
"Armor/**/*.cpp"
)

file (GLOB_RECURSE calfiles
"config/src/rmconfig.cpp"
)


add_executable(autocar main.cpp ${sourcefiles})
add_executable(calibrate calibrate_get_imgs.cpp ${calfiles})


target_link_libraries(rmcv ${OpenCV_LIBS} -lglog -lpthread  libtinytrt.so nvinfer nvinfer_plugin nvparsers nvonnxparser)
target_link_libraries(calibrate  ${OpenCV_LIBS} -lglog -lpthread)
